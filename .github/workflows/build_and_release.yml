name: Package Games And Release

permissions:
    contents: write

on:
    workflow_dispatch:
    push:
        branches: ["main"]

jobs:
    Build-And-Release:
        runs-on: windows-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v3

            - name: Setup python
              uses: actions/setup-python@v4
              with:
                python-version: '3.11'
            
            - name: Install requirements
              run: pip install -r requirements.txt

            - name: Package
              run: pyinstaller --onefile -w ConwayGameOfLife/main.py -n ConwayGameOfLife
            
            # - name: Upload Artifacts
            #   uses: softprops/action-gh-release@v1
            #   env:
            #     GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
            #   with:
            #     body_path: release.md
            #     files: |
            #         dist/ConwayGameOfLife.exe
            #         LICENSE
            - name: GH Release
              run: |
                gh release create --notes-file release.md 'dist/ConwayGameOfLife.exe# ConwayGameOfLife' -t GameOfLife
              env:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

